"use strict";(self.webpackChunksmm_encyclopedia=self.webpackChunksmm_encyclopedia||[]).push([[819],{24819:(t,e,i)=>{i.d(e,{Z:()=>vt});var n=i(66274),s=i(99359),r=i(72791),l=(0,s.Z)("state"),a=(0,s.Z)("isLoading"),o=(0,s.Z)("isFromEventDirectly");class u{constructor(t,e,i){Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,o,{writable:!0,value:void 0}),(0,n.Z)(this,l)[l]=t instanceof u?t.state:t,(0,n.Z)(this,a)[a]=e instanceof u?e.isLoading:e,(0,n.Z)(this,o)[o]=i instanceof u?i.isFromEventDirectly:i}get state(){return(0,n.Z)(this,l)[l]}get isLoading(){return(0,n.Z)(this,a)[a]}get isFromEventDirectly(){return(0,n.Z)(this,o)[o]}equals(t){return null!=t&&(t instanceof u&&(this.state===t.state&&this.isLoading===t.isLoading&&this.isFromEventDirectly===t.isFromEventDirectly))}}var h=(0,s.Z)("playElement"),d=(0,s.Z)("pauseElement"),c=(0,s.Z)("stopElement"),v=(0,s.Z)("loadingElement"),p=(0,s.Z)("exceptionElement");class f{constructor(t,e,i,s,r){Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),(0,n.Z)(this,h)[h]=t,(0,n.Z)(this,d)[d]=e,(0,n.Z)(this,c)[c]=i,(0,n.Z)(this,v)[v]=s,(0,n.Z)(this,p)[p]=r}get playElement(){return(0,n.Z)(this,h)[h]}get pauseElement(){return(0,n.Z)(this,d)[d]}get stopElement(){return(0,n.Z)(this,c)[c]}get loadingElement(){return(0,n.Z)(this,v)[v]}get exceptionElement(){return(0,n.Z)(this,p)[p]}}var Z=i(19870),y=(0,s.Z)("map");class P{constructor(t){if(!Z.b){const e=P.map;if(e.has(t))throw new ReferenceError('A duplicate sound player was found with the same key "'.concat(t,'".'));e.set(t,this)}}static get map(){var t,e;return null!==(e=(t=(0,n.Z)(this,y))[y])&&void 0!==e?e:t[y]=new Map}}P.DEFAULT_DOES_LOOP=!1,Object.defineProperty(P,y,{writable:!0,value:void 0});var b,g,E=i(56787),w=i(77844),m=(0,s.Z)("englishName");class S extends E.Enum{constructor(t){super(),Object.defineProperty(this,m,{writable:!0,value:void 0}),(0,n.Z)(this,m)[m]=t}get englishName(){return(0,n.Z)(this,m)[m]}get englishNameInHtml(){return this.englishName}}S.STANDBY=new class extends S{getElementsFrom(t){let{playElement:e}=t;return[e()]}}("standby"),S.PAUSED=new class extends S{getElementsFrom(t){let{playElement:e,stopElement:i}=t;return[e(),i()]}}("paused"),S.PLAYING=new class extends S{getElementsFrom(t){let{pauseElement:e,stopElement:i}=t;return[e(),i()]}}("playing"),S.LOADING=new class extends S{getElementsFrom(t){let{loadingElement:e}=t;return[e()]}}("loading"),S.EXCEPTION=new class extends S{getElementsFrom(t){let{exceptionElement:e}=t;return[e()]}}("exception"),S.CompanionEnum=(g=(0,s.Z)("instance"),b=class t extends w.S{constructor(){super(S)}static get get(){var e,i;return null!==(i=(e=(0,n.Z)(this,g))[g])&&void 0!==i?i:e[g]=new t}},Object.defineProperty(b,g,{writable:!0,value:void 0}),b);var O=(0,s.Z)("history"),A=(0,s.Z)("last"),j=(0,s.Z)("current");class L{constructor(t){if(Object.defineProperty(this,O,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,j,{writable:!0,value:void 0}),t===S.LOADING)throw new ReferenceError("The first state of the history cannot be the loading state!");(0,n.Z)(this,j)[j]=new u(t,!1,!1),(0,n.Z)(this,O)[O]=[this.current]}get history(){return(0,n.Z)(this,O)[O]}get _history(){return(0,n.Z)(this,O)[O]}get current(){return(0,n.Z)(this,j)[j]}set current(t){null!=t&&(this.last=this.current,this._history.push((0,n.Z)(this,j)[j]=t))}setCurrent(t){return this.current=t,this}get last(){if(null==(0,n.Z)(this,A)[A])throw new ReferenceError("The history has no last state!");return(0,n.Z)(this,A)[A]}set last(t){if(null==t)throw new TypeError("The last state could not be set to a null value.");(0,n.Z)(this,A)[A]=t}setLast(t){return this.last=t,this}}const{STANDBY:C,PAUSED:N,PLAYING:x,EXCEPTION:_}=S;var B,D,F=(0,s.Z)("source"),T=(0,s.Z)("title"),Y=(0,s.Z)("doesLoop"),k=(0,s.Z)("history"),I=(0,s.Z)("audio"),R=(0,s.Z)("isDurationValid"),U=(0,s.Z)("onBeforePlay"),G=(0,s.Z)("onAfterPlay"),V=(0,s.Z)("onBeforePause"),X=(0,s.Z)("onAfterPause"),q=(0,s.Z)("onBeforeStop"),H=(0,s.Z)("onAfterStop"),M=(0,s.Z)("onBeforeStateChanged"),W=(0,s.Z)("onAfterStateChanged"),z=(0,s.Z)("onPlayEvent"),J=(0,s.Z)("onPlayingEvent"),K=(0,s.Z)("onPauseEvent"),Q=(0,s.Z)("onEndEvent");class $ extends P{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:P.DEFAULT_DOES_LOOP;super(t.key),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,Y,{writable:!0,value:void 0}),Object.defineProperty(this,k,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),Object.defineProperty(this,X,{writable:!0,value:void 0}),Object.defineProperty(this,q,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:void 0}),Object.defineProperty(this,J,{writable:!0,value:void 0}),Object.defineProperty(this,K,{writable:!0,value:void 0}),Object.defineProperty(this,Q,{writable:!0,value:void 0}),(0,n.Z)(this,F)[F]=t,(0,n.Z)(this,T)[T]=e,(0,n.Z)(this,Y)[Y]=i,this.setState(((0,n.Z)(this,k)[k]=new L(C)).current)}get source(){return(0,n.Z)(this,F)[F]}get title(){return(0,n.Z)(this,T)[T]}get doesLoop(){return(0,n.Z)(this,Y)[Y]}get history(){return(0,n.Z)(this,k)[k]}get audio(){if(null!=(0,n.Z)(this,I)[I])return(0,n.Z)(this,I)[I];const t=new Audio(this.source.fullName);return t.onplaying=t=>{var e;switch(this.history.current.state){case C:return this.stop();case N:return this.pause()}this.setState(new u(x,!1,!0)),null===(e=this.onPlayingEvent)||void 0===e||e.call(this,this,t)},t.onpause=t=>{var e;this.history.current.state!==C&&this.setState(new u(N,!1,!0)),null===(e=this.onPauseEvent)||void 0===e||e.call(this,this,t)},t.onplay=t=>{var e;this.setState(new u(x,!0,!0)),null===(e=this.onPlayEvent)||void 0===e||e.call(this,this,t)},t.onended=t=>{var e;this.setState(new u(C,!1,!0)),null===(e=this.onEndEvent)||void 0===e||e.call(this,this,t)},t.title=this.title,t.loop=this.doesLoop,(0,n.Z)(this,I)[I]=t}get isAudioExistant(){return null!=(0,n.Z)(this,I)[I]}get isPaused(){var t,e;return null!==(t=null===(e=(0,n.Z)(this,I)[I])||void 0===e?void 0:e.paused)&&void 0!==t&&t}get isDurationValid(){return null!=(0,n.Z)(this,R)[R]?(0,n.Z)(this,R)[R]:!!this.isAudioExistant&&((0,n.Z)(this,R)[R]=Number.isFinite(this.audio.duration))}get onBeforePlay(){var t;return null!==(t=(0,n.Z)(this,U)[U])&&void 0!==t?t:null}set onBeforePlay(t){(0,n.Z)(this,U)[U]=null!==t&&void 0!==t?t:null}setOnBeforePlay(t){return this.onBeforePlay=t,this}get onAfterPlay(){var t;return null!==(t=(0,n.Z)(this,G)[G])&&void 0!==t?t:null}set onAfterPlay(t){(0,n.Z)(this,G)[G]=null!==t&&void 0!==t?t:null}setOnAfterPlay(t){return this.onAfterPlay=t,this}get onBeforePause(){var t;return null!==(t=(0,n.Z)(this,V)[V])&&void 0!==t?t:null}set onBeforePause(t){(0,n.Z)(this,V)[V]=null!==t&&void 0!==t?t:null}setOnBeforePause(t){return this.onBeforePause=t,this}get onAfterPause(){var t;return null!==(t=(0,n.Z)(this,X)[X])&&void 0!==t?t:null}set onAfterPause(t){(0,n.Z)(this,X)[X]=null!==t&&void 0!==t?t:null}setOnAfterPause(t){return this.onAfterPause=t,this}get onBeforeStop(){var t;return null!==(t=(0,n.Z)(this,q)[q])&&void 0!==t?t:null}set onBeforeStop(t){(0,n.Z)(this,q)[q]=null!==t&&void 0!==t?t:null}setOnBeforeStop(t){return this.onBeforeStop=t,this}get onAfterStop(){var t;return null!==(t=(0,n.Z)(this,H)[H])&&void 0!==t?t:null}set onAfterStop(t){(0,n.Z)(this,H)[H]=null!==t&&void 0!==t?t:null}setOnAfterStop(t){return this.onAfterStop=t,this}get onBeforeStateChanged(){var t;return null!==(t=(0,n.Z)(this,M)[M])&&void 0!==t?t:null}set onBeforeStateChanged(t){(0,n.Z)(this,M)[M]=null!==t&&void 0!==t?t:null}setOnBeforeStateChanged(t){return this.onBeforeStateChanged=t,this}get onAfterStateChanged(){var t;return null!==(t=(0,n.Z)(this,W)[W])&&void 0!==t?t:null}set onAfterStateChanged(t){(0,n.Z)(this,W)[W]=null!==t&&void 0!==t?t:null}setOnAfterStateChanged(t){return this.onAfterStateChanged=t,this}get onPlayingEvent(){var t;return null!==(t=(0,n.Z)(this,J)[J])&&void 0!==t?t:null}set onPlayingEvent(t){(0,n.Z)(this,J)[J]=null!==t&&void 0!==t?t:null}setOnPlayingEvent(t){return this.onPlayingEvent=t,this}get onPlayEvent(){var t;return null!==(t=(0,n.Z)(this,z)[z])&&void 0!==t?t:null}set onPlayEvent(t){(0,n.Z)(this,z)[z]=null!==t&&void 0!==t?t:null}setOnPlayEvent(t){return this.onPlayEvent=t,this}get onPauseEvent(){var t;return null!==(t=(0,n.Z)(this,K)[K])&&void 0!==t?t:null}set onPauseEvent(t){(0,n.Z)(this,K)[K]=null!==t&&void 0!==t?t:null}setOnPauseEvent(t){return this.onPauseEvent=t,this}get onEndEvent(){var t;return null!==(t=(0,n.Z)(this,Q)[Q])&&void 0!==t?t:null}set onEndEvent(t){(0,n.Z)(this,Q)[Q]=null!==t&&void 0!==t?t:null}setOnEndEvent(t){return this.onEndEvent=t,this}play(){var t,e;const i=this.history.current;if(i.isLoading)return this.setState(new u(x,!0,!1));if(i.state===x)return this;null===(t=this.onBeforePlay)||void 0===t||t.call(this,this);return this.audio.play().then((()=>this.isDurationValid?this:this.setState(new u(_,!1,!1)))).catch((()=>this.setState(new u(_,!1,!1)))),this.setState(new u(x,!0,!1)),null===(e=this.onAfterPlay)||void 0===e||e.call(this,this),this}pause(){var t,e;const i=this.history.current,n=i.isLoading,s=i.state===N;if(!n||!s){if(n)return this.setState(new u(N,!0,!1));if(s)return this}return null===(t=this.onBeforePause)||void 0===t||t.call(this,this),this.audio.pause(),this.setState(new u(N,!1,!1)),null===(e=this.onAfterPause)||void 0===e||e.call(this,this),this}stop(){var t,e;const i=this.history.current,n=i.isLoading,s=i.state===C;if(!n||!s){if(n)return this.setState(new u(C,!0,!1));if(s)return this}null===(t=this.onBeforeStop)||void 0===t||t.call(this,this);const r=this.audio;return r.pause(),r.currentTime=0,this.setState(new u(C,!1,!1)),null===(e=this.onAfterStop)||void 0===e||e.call(this,this),this}setState(t){var e,i;const n=this.history,s=n.current;return s.equals(t)||(null===(e=this.onBeforeStateChanged)||void 0===e||e.call(this,this,t,s),n.current=t,null===(i=this.onAfterStateChanged)||void 0===i||i.call(this,this,t,s)),this}}class tt{static createSimple(t,e,i){return new $(t,e,null!==i&&void 0!==i?i:P.DEFAULT_DOES_LOOP)}}var et=(0,s.Z)("englishName");class it extends E.Enum{constructor(t){super(),Object.defineProperty(this,et,{writable:!0,value:void 0}),(0,n.Z)(this,et)[et]=t}get englishName(){return(0,n.Z)(this,et)[et]}get englishNameInHtml(){return this.englishName}onCreate(t){}onPlay(t){return null}}it.ALL_YES=new class extends it{onCreate(t){t(!0)}onPlay(t){return t(!0),!0}}("all yes"),it.ALL_NO=new class extends it{onCreate(t){t(!1)}onPlay(t){return t(!1),!1}}("all no"),it.ON_PLAY_ONLY=new class extends it{onPlay(t){return t(),null}}("on play only"),it.ON_CREATE_ONLY=new class extends it{onCreate(t){t()}}("on create only"),it.CompanionEnum=(D=(0,s.Z)("instance"),B=class t extends w.S{constructor(){super(it),this._DEFAULT=it.ON_PLAY_ONLY}static get get(){var e,i;return null!==(i=(e=(0,n.Z)(this,D))[D])&&void 0!==i?i:e[D]=new t}},Object.defineProperty(B,D,{writable:!0,value:void 0}),B);var nt=i(80184);const{STANDBY:st,LOADING:rt}=S;var lt=(0,s.Z)("PLAY_CLASSES"),at=(0,s.Z)("PAUSE_CLASSES"),ot=(0,s.Z)("STOP_CLASSES"),ut=(0,s.Z)("LOADING_CLASSES"),ht=(0,s.Z)("EXCEPTION_CLASSES"),dt=(0,s.Z)("audio"),ct=(0,s.Z)("isSourceFoundCallback");class vt extends r.Component{constructor(t){super(t),Object.defineProperty(this,dt,{writable:!0,value:void 0}),Object.defineProperty(this,ct,{writable:!0,value:void 0}),this.state={state:new u(st,!1,!1),isSourceRetrieved:!1},(0,n.Z)(this,ct)[ct]=t=>{this._audio.isDurationValid;this.setState({isSourceRetrieved:!0})}}get file(){return this.props.file}get title(){return this.props.title}get validator(){var t;return null!==(t=this.props.validator)&&void 0!==t?t:it.CompanionEnum.get.defaultValue}get componentState(){return this.state.state}get isSourceRetrieved(){return this.state.isSourceRetrieved}get _audio(){if(null!=(0,n.Z)(this,dt)[dt])return(0,n.Z)(this,dt)[dt];const t=this.file;return(0,n.Z)(this,dt)[dt]=tt.createSimple(t,this.title).setOnBeforePlay((()=>this.validator.onPlay((0,n.Z)(this,ct)[ct]))).setOnAfterStateChanged((t=>this.setState({state:t.history.current})))}componentDidMount(){this.isSourceRetrieved||this.validator.onCreate((0,n.Z)(this,ct)[ct])}componentWillUnmount(){const t=(0,n.Z)(this,dt)[dt];null!=t&&(t.setState(new u(st,!1,!1)),P.map.delete(t.source.key))}render(){const t=new f((()=>(0,nt.jsx)("div",{className:(0,n.Z)(vt,lt)[lt],onClick:()=>this._audio.play()},"".concat(this.title," - play"))),(()=>(0,nt.jsx)("div",{className:(0,n.Z)(vt,at)[at],onClick:()=>this._audio.pause()},"".concat(this.title," - pause"))),(()=>(0,nt.jsx)("div",{className:(0,n.Z)(vt,ot)[ot],onClick:()=>this._audio.stop()},"".concat(this.title," - stop"))),(()=>(0,nt.jsx)("div",{className:(0,n.Z)(vt,ut)[ut],role:"status"},"".concat(this.title," - loading"))),(()=>(0,nt.jsx)("div",{className:(0,n.Z)(vt,ht)[ht]},"".concat(this.title," - exception")))),e=this.componentState;return(0,nt.jsxs)("div",{className:"audio-state-container container",children:[e.isLoading?rt.getElementsFrom(t):null,e.state.getElementsFrom(t)]},"".concat(this.title," - container"))}}Object.defineProperty(vt,lt,{writable:!0,value:"btn btn-lg bi-play-btn-fill audio-state audio-state-play"}),Object.defineProperty(vt,at,{writable:!0,value:"btn btn-lg bi-pause-btn-fill audio-state audio-state-pause"}),Object.defineProperty(vt,ot,{writable:!0,value:"btn btn-lg bi-stop-btn-fill audio-state audio-state-stop"}),Object.defineProperty(vt,ut,{writable:!0,value:"spinner-border audio-state audio-state-loading"}),Object.defineProperty(vt,ht,{writable:!0,value:"bi-shield-fill-exclamation audio-state audio-state-exception"})}}]);
//# sourceMappingURL=819.e7d75309.chunk.js.map