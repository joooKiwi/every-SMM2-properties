"use strict";(self.webpackChunksmm_encyclopedia=self.webpackChunksmm_encyclopedia||[]).push([[16],{67016:(t,e,i)=>{i.d(e,{A:()=>ft});var n=i(4473),s=i(68341),r=i(65043),l=(0,s.A)("state"),a=(0,s.A)("isLoading"),o=(0,s.A)("isFromEventDirectly");class u{constructor(t,e,i){Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,o,{writable:!0,value:void 0}),(0,n.A)(this,l)[l]=t instanceof u?t.state:t,(0,n.A)(this,a)[a]=e instanceof u?e.isLoading:e,(0,n.A)(this,o)[o]=i instanceof u?i.isFromEventDirectly:i}get state(){return(0,n.A)(this,l)[l]}get isLoading(){return(0,n.A)(this,a)[a]}get isFromEventDirectly(){return(0,n.A)(this,o)[o]}equals(t){return null!=t&&(t instanceof u&&(this.state===t.state&&this.isLoading===t.isLoading&&this.isFromEventDirectly===t.isFromEventDirectly))}}var h=(0,s.A)("playElement"),d=(0,s.A)("pauseElement"),c=(0,s.A)("stopElement"),v=(0,s.A)("loadingElement"),A=(0,s.A)("exceptionElement");class p{constructor(t,e,i,s,r){Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),(0,n.A)(this,h)[h]=t,(0,n.A)(this,d)[d]=e,(0,n.A)(this,c)[c]=i,(0,n.A)(this,v)[v]=s,(0,n.A)(this,A)[A]=r}get playElement(){return(0,n.A)(this,h)[h]}get pauseElement(){return(0,n.A)(this,d)[d]}get stopElement(){return(0,n.A)(this,c)[c]}get loadingElement(){return(0,n.A)(this,v)[v]}get exceptionElement(){return(0,n.A)(this,A)[A]}}var f,y=i(10891);class P{constructor(t){if(!y.bP){const e=P.allSoundPlayer;if(e.has(t))throw new ReferenceError('A duplicate sound player was found with the same key "'.concat(t,'".'));e.set(t,this)}}}(f=P||(P={})).DEFAULT_DOES_LOOP=!1,f.allSoundPlayer=new Map;var g,b,E,w=i(52129),S=i(75336),m=(0,s.A)("englishName");class O extends w.Enum{constructor(t){super(),Object.defineProperty(this,m,{writable:!0,value:void 0}),(0,n.A)(this,m)[m]=t}get englishName(){return(0,n.A)(this,m)[m]}get englishNameInHtml(){return this.englishName}}g=O,O.STANDBY=new class extends g{getElementsFrom(t){let{playElement:e}=t;return[e()]}}("standby"),O.PAUSED=new class extends g{getElementsFrom(t){let{playElement:e,stopElement:i}=t;return[e(),i()]}}("paused"),O.PLAYING=new class extends g{getElementsFrom(t){let{pauseElement:e,stopElement:i}=t;return[e(),i()]}}("playing"),O.LOADING=new class extends g{getElementsFrom(t){let{loadingElement:e}=t;return[e()]}}("loading"),O.EXCEPTION=new class extends g{getElementsFrom(t){let{exceptionElement:e}=t;return[e()]}}("exception"),O.CompanionEnum=(E=(0,s.A)("instance"),b=class t extends S.y{constructor(){super(g)}static get get(){var e,i;return null!==(i=(e=(0,n.A)(this,E))[E])&&void 0!==i?i:e[E]=new t}},Object.defineProperty(b,E,{writable:!0,value:void 0}),b);var j=(0,s.A)("history"),C=(0,s.A)("last"),L=(0,s.A)("current");class N{constructor(t){if(Object.defineProperty(this,j,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),t===O.LOADING)throw new ReferenceError("The first state of the history cannot be the loading state!");(0,n.A)(this,L)[L]=new u(t,!1,!1),(0,n.A)(this,j)[j]=[this.current]}get history(){return(0,n.A)(this,j)[j]}get _history(){return(0,n.A)(this,j)[j]}get current(){return(0,n.A)(this,L)[L]}set current(t){null!=t&&(this.last=this.current,this._history.push((0,n.A)(this,L)[L]=t))}setCurrent(t){return this.current=t,this}get last(){if(null==(0,n.A)(this,C)[C])throw new ReferenceError("The history has no last state!");return(0,n.A)(this,C)[C]}set last(t){if(null==t)throw new TypeError("The last state could not be set to a null value.");(0,n.A)(this,C)[C]=t}setLast(t){return this.last=t,this}}const{STANDBY:x,PAUSED:B,PLAYING:_,EXCEPTION:D}=O;var F,T,Y,k=(0,s.A)("source"),I=(0,s.A)("title"),R=(0,s.A)("doesLoop"),U=(0,s.A)("history"),G=(0,s.A)("audio"),V=(0,s.A)("isDurationValid"),X=(0,s.A)("onBeforePlay"),q=(0,s.A)("onAfterPlay"),H=(0,s.A)("onBeforePause"),M=(0,s.A)("onAfterPause"),W=(0,s.A)("onBeforeStop"),z=(0,s.A)("onAfterStop"),J=(0,s.A)("onBeforeStateChanged"),K=(0,s.A)("onAfterStateChanged"),Q=(0,s.A)("onPlayEvent"),Z=(0,s.A)("onPlayingEvent"),$=(0,s.A)("onPauseEvent"),tt=(0,s.A)("onEndEvent");class et extends P{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:P.DEFAULT_DOES_LOOP;super(t.key),Object.defineProperty(this,k,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),Object.defineProperty(this,X,{writable:!0,value:void 0}),Object.defineProperty(this,q,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:void 0}),Object.defineProperty(this,J,{writable:!0,value:void 0}),Object.defineProperty(this,K,{writable:!0,value:void 0}),Object.defineProperty(this,Q,{writable:!0,value:void 0}),Object.defineProperty(this,Z,{writable:!0,value:void 0}),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,tt,{writable:!0,value:void 0}),(0,n.A)(this,k)[k]=t,(0,n.A)(this,I)[I]=e,(0,n.A)(this,R)[R]=i,this.setState(((0,n.A)(this,U)[U]=new N(x)).current)}get source(){return(0,n.A)(this,k)[k]}get title(){return(0,n.A)(this,I)[I]}get doesLoop(){return(0,n.A)(this,R)[R]}get history(){return(0,n.A)(this,U)[U]}get audio(){if(null!=(0,n.A)(this,G)[G])return(0,n.A)(this,G)[G];const t=new Audio(this.source.fullName);return t.onplaying=t=>{var e;switch(this.history.current.state){case x:return this.stop();case B:return this.pause()}return this.setState(new u(_,!1,!0)),null===(e=this.onPlayingEvent)||void 0===e||e.call(this,this,t),null},t.onpause=t=>{var e;this.history.current.state!==x&&this.setState(new u(B,!1,!0)),null===(e=this.onPauseEvent)||void 0===e||e.call(this,this,t)},t.onplay=t=>{var e;this.setState(new u(_,!0,!0)),null===(e=this.onPlayEvent)||void 0===e||e.call(this,this,t)},t.onended=t=>{var e;this.setState(new u(x,!1,!0)),null===(e=this.onEndEvent)||void 0===e||e.call(this,this,t)},t.title=this.title,t.loop=this.doesLoop,(0,n.A)(this,G)[G]=t}get isAudioExistant(){return null!=(0,n.A)(this,G)[G]}get isPaused(){var t,e;return null!==(t=null===(e=(0,n.A)(this,G)[G])||void 0===e?void 0:e.paused)&&void 0!==t&&t}get isDurationValid(){return null!=(0,n.A)(this,V)[V]?(0,n.A)(this,V)[V]:!!this.isAudioExistant&&((0,n.A)(this,V)[V]=Number.isFinite(this.audio.duration))}get onBeforePlay(){var t;return null!==(t=(0,n.A)(this,X)[X])&&void 0!==t?t:null}set onBeforePlay(t){(0,n.A)(this,X)[X]=null!==t&&void 0!==t?t:null}setOnBeforePlay(t){return this.onBeforePlay=t,this}get onAfterPlay(){var t;return null!==(t=(0,n.A)(this,q)[q])&&void 0!==t?t:null}set onAfterPlay(t){(0,n.A)(this,q)[q]=null!==t&&void 0!==t?t:null}setOnAfterPlay(t){return this.onAfterPlay=t,this}get onBeforePause(){var t;return null!==(t=(0,n.A)(this,H)[H])&&void 0!==t?t:null}set onBeforePause(t){(0,n.A)(this,H)[H]=null!==t&&void 0!==t?t:null}setOnBeforePause(t){return this.onBeforePause=t,this}get onAfterPause(){var t;return null!==(t=(0,n.A)(this,M)[M])&&void 0!==t?t:null}set onAfterPause(t){(0,n.A)(this,M)[M]=null!==t&&void 0!==t?t:null}setOnAfterPause(t){return this.onAfterPause=t,this}get onBeforeStop(){var t;return null!==(t=(0,n.A)(this,W)[W])&&void 0!==t?t:null}set onBeforeStop(t){(0,n.A)(this,W)[W]=null!==t&&void 0!==t?t:null}setOnBeforeStop(t){return this.onBeforeStop=t,this}get onAfterStop(){var t;return null!==(t=(0,n.A)(this,z)[z])&&void 0!==t?t:null}set onAfterStop(t){(0,n.A)(this,z)[z]=null!==t&&void 0!==t?t:null}setOnAfterStop(t){return this.onAfterStop=t,this}get onBeforeStateChanged(){var t;return null!==(t=(0,n.A)(this,J)[J])&&void 0!==t?t:null}set onBeforeStateChanged(t){(0,n.A)(this,J)[J]=null!==t&&void 0!==t?t:null}setOnBeforeStateChanged(t){return this.onBeforeStateChanged=t,this}get onAfterStateChanged(){var t;return null!==(t=(0,n.A)(this,K)[K])&&void 0!==t?t:null}set onAfterStateChanged(t){(0,n.A)(this,K)[K]=null!==t&&void 0!==t?t:null}setOnAfterStateChanged(t){return this.onAfterStateChanged=t,this}get onPlayingEvent(){var t;return null!==(t=(0,n.A)(this,Z)[Z])&&void 0!==t?t:null}set onPlayingEvent(t){(0,n.A)(this,Z)[Z]=null!==t&&void 0!==t?t:null}setOnPlayingEvent(t){return this.onPlayingEvent=t,this}get onPlayEvent(){var t;return null!==(t=(0,n.A)(this,Q)[Q])&&void 0!==t?t:null}set onPlayEvent(t){(0,n.A)(this,Q)[Q]=null!==t&&void 0!==t?t:null}setOnPlayEvent(t){return this.onPlayEvent=t,this}get onPauseEvent(){var t;return null!==(t=(0,n.A)(this,$)[$])&&void 0!==t?t:null}set onPauseEvent(t){(0,n.A)(this,$)[$]=null!==t&&void 0!==t?t:null}setOnPauseEvent(t){return this.onPauseEvent=t,this}get onEndEvent(){var t;return null!==(t=(0,n.A)(this,tt)[tt])&&void 0!==t?t:null}set onEndEvent(t){(0,n.A)(this,tt)[tt]=null!==t&&void 0!==t?t:null}setOnEndEvent(t){return this.onEndEvent=t,this}play(){var t,e;const i=this.history.current;if(i.isLoading)return this.setState(new u(_,!0,!1));if(i.state===_)return this;null===(t=this.onBeforePlay)||void 0===t||t.call(this,this);return this.audio.play().then((()=>this.isDurationValid?this:this.setState(new u(D,!1,!1)))).catch((()=>this.setState(new u(D,!1,!1)))),this.setState(new u(_,!0,!1)),null===(e=this.onAfterPlay)||void 0===e||e.call(this,this),this}pause(){var t,e;const i=this.history.current,n=i.isLoading,s=i.state===B;if(!n||!s){if(n)return this.setState(new u(B,!0,!1));if(s)return this}return null===(t=this.onBeforePause)||void 0===t||t.call(this,this),this.audio.pause(),this.setState(new u(B,!1,!1)),null===(e=this.onAfterPause)||void 0===e||e.call(this,this),this}stop(){var t,e;const i=this.history.current,n=i.isLoading,s=i.state===x;if(!n||!s){if(n)return this.setState(new u(x,!0,!1));if(s)return this}null===(t=this.onBeforeStop)||void 0===t||t.call(this,this);const r=this.audio;return r.pause(),r.currentTime=0,this.setState(new u(x,!1,!1)),null===(e=this.onAfterStop)||void 0===e||e.call(this,this),this}setState(t){var e,i;const n=this.history,s=n.current;return s.equals(t)||(null===(e=this.onBeforeStateChanged)||void 0===e||e.call(this,this,t,s),n.current=t,null===(i=this.onAfterStateChanged)||void 0===i||i.call(this,this,t,s)),this}}var it=(0,s.A)("englishName");class nt extends w.Enum{constructor(t){super(),Object.defineProperty(this,it,{writable:!0,value:void 0}),(0,n.A)(this,it)[it]=t}get englishName(){return(0,n.A)(this,it)[it]}get englishNameInHtml(){return this.englishName}onCreate(t){}onPlay(t){return null}}F=nt,nt.ALL_YES=new class extends F{onCreate(t){t(!0)}onPlay(t){return t(!0),!0}}("all yes"),nt.ALL_NO=new class extends F{onCreate(t){t(!1)}onPlay(t){return t(!1),!1}}("all no"),nt.ON_PLAY_ONLY=new class extends F{onPlay(t){return t(),null}}("on play only"),nt.ON_CREATE_ONLY=new class extends F{onCreate(t){t()}}("on create only"),nt.CompanionEnum=(Y=(0,s.A)("instance"),T=class t extends S.y{constructor(){super(F),this._DEFAULT=F.ON_PLAY_ONLY}static get get(){var e,i;return null!==(i=(e=(0,n.A)(this,Y))[Y])&&void 0!==i?i:e[Y]=new t}},Object.defineProperty(T,Y,{writable:!0,value:void 0}),T),(nt||(nt={})).Companion=nt.CompanionEnum.get;var st=i(70579),rt=nt.Companion,lt=P.allSoundPlayer;const{STANDBY:at,LOADING:ot}=O;var ut=(0,s.A)("PLAY_CLASSES"),ht=(0,s.A)("PAUSE_CLASSES"),dt=(0,s.A)("STOP_CLASSES"),ct=(0,s.A)("LOADING_CLASSES"),vt=(0,s.A)("EXCEPTION_CLASSES"),At=(0,s.A)("audio"),pt=(0,s.A)("isSourceFoundCallback");class ft extends r.Component{constructor(t){super(t),Object.defineProperty(this,At,{writable:!0,value:void 0}),Object.defineProperty(this,pt,{writable:!0,value:void 0}),this.state={state:new u(at,!1,!1),isSourceRetrieved:!1},(0,n.A)(this,pt)[pt]=t=>{this._audio.isDurationValid;this.setState({isSourceRetrieved:!0})}}get file(){return this.props.file}get title(){return this.props.title}get validator(){var t;return null!==(t=this.props.validator)&&void 0!==t?t:rt.defaultValue}get componentState(){return this.state.state}get isSourceRetrieved(){return this.state.isSourceRetrieved}get _audio(){if(null!=(0,n.A)(this,At)[At])return(0,n.A)(this,At)[At];const t=this.file;return(0,n.A)(this,At)[At]=new et(t,this.title).setOnBeforePlay((()=>this.validator.onPlay((0,n.A)(this,pt)[pt]))).setOnAfterStateChanged((t=>this.setState({state:t.history.current})))}componentDidMount(){this.isSourceRetrieved||this.validator.onCreate((0,n.A)(this,pt)[pt])}componentWillUnmount(){const t=(0,n.A)(this,At)[At];null!=t&&(t.setState(new u(at,!1,!1)),lt.delete(t.source.key))}render(){const t=new p((()=>(0,st.jsx)("div",{className:(0,n.A)(ft,ut)[ut],onClick:()=>this._audio.play()},"".concat(this.title," - play"))),(()=>(0,st.jsx)("div",{className:(0,n.A)(ft,ht)[ht],onClick:()=>this._audio.pause()},"".concat(this.title," - pause"))),(()=>(0,st.jsx)("div",{className:(0,n.A)(ft,dt)[dt],onClick:()=>this._audio.stop()},"".concat(this.title," - stop"))),(()=>(0,st.jsx)("div",{className:(0,n.A)(ft,ct)[ct],role:"status"},"".concat(this.title," - loading"))),(()=>(0,st.jsx)("div",{className:(0,n.A)(ft,vt)[vt]},"".concat(this.title," - exception")))),e=this.componentState;return(0,st.jsxs)("div",{className:"audio-state-container container",children:[e.isLoading?ot.getElementsFrom(t):null,e.state.getElementsFrom(t)]},"".concat(this.title," - container"))}}Object.defineProperty(ft,ut,{writable:!0,value:"btn btn-lg bi-play-btn-fill audio-state audio-state-play"}),Object.defineProperty(ft,ht,{writable:!0,value:"btn btn-lg bi-pause-btn-fill audio-state audio-state-pause"}),Object.defineProperty(ft,dt,{writable:!0,value:"btn btn-lg bi-stop-btn-fill audio-state audio-state-stop"}),Object.defineProperty(ft,ct,{writable:!0,value:"spinner-border audio-state audio-state-loading"}),Object.defineProperty(ft,vt,{writable:!0,value:"bi-shield-fill-exclamation audio-state audio-state-exception"})}}]);
//# sourceMappingURL=16.4039e5ba.chunk.js.map